############################################################
#
# Night Mode On Script
#
############################################################

night_mode_on:
  sequence:
    - service: remote.turn_on
      entity_id: remote.harmony
      data:
        activity: -1
    - service: homeassistant.turn_off
      data:
        entity_id: switch.nixieclock_switch
    - service: homeassistant.turn_off
      data_template:
        entity_id: >
          {%- if is_state('input_boolean.guest_mode', 'off') -%}
            group.all_lights_except_bedroom
          {%- else -%}
            group.all_lights_except_bedroom_and_guest
          {% endif %}

############################################################
#
# Night Mode Off Script
#
############################################################

night_mode_off:
  sequence:
    - service: remote.turn_on
      entity_id: remote.harmony
      data:
        activity: 24716734
    - service: media_player.play_media
      data_template:
        entity_id: media_player.living_room
        media_content_id: >
          {%- if now().strftime('%A') == 'Saturday' -%}
            http://bbcmedia.ic.llnwd.net/stream/bbcmedia_radio2_mf_p
          {%- else -%}
            http://media-the.musicradio.com:80/ClassicFMMP3
          {% endif %}
        media_content_type: 'audio/mp4'
    - service: input_boolean.turn_off
      data:
        entity_id: input_boolean.night_mode

    # Check if night - if yes turn on lights, if no stop script

    - condition: state
      entity_id: 'sensor.light_sensor'
      state: 'Night'
    - service: scene.turn_on
      data:
        entity_id: scene.reading
